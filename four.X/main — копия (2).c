/*
 * File:   main.c
 * Author: ?????
 *
 * Created on August 19, 2019, 6:53 PM
 */


#include <xc.h>
#include <stdio.h>
#include <stdlib.h> 
// FICD
#define FCY 10000000
#define BAUDRATE 9600
#define BRGVAL ((FCY/BAUDRATE)/16)-1
#include <libpic30.h>
// #pragma config statements should precede project file includes.
// Use project enums instead of #define for ON and OFF.
void main(void) {
    TRISBbits.TRISB12=0;
    TRISBbits.TRISB10=0;
    TRISBbits.TRISB11=0;
    RPINR22bits.SDI2R = 42;
    RPINR22bits.SCK2R = 43;
    SPI1CON1bits.DISSCK = 0; 	//????????? ?????????? ???????? ???????? SCK.
     SPI1CON1bits.DISSDO = 0; 	//????? SDOx ??????????? ??????? SPI.
     SPI1CON1bits.MODE16 = 0; 	//???????????? ?????????????? ? ??????? ???? (8-?? ??????).
     SPI1CON1bits.SMP = 0; 	//??????? ?????? ?????????? ? ???????? ?????? ??????.
     SPI1CON1bits.CKE = 0; 	// ???????????????? ???????? ?????? ?????????? ??
// ????????? ?????? ????????? ???????
     SPI1CON1bits.SPRE = 0b111; 	//??????????? ????????? ????????????. 1:1
     SPI1CON1bits.PPRE = 0b11; 	// ??????????? ????????? ????????????. 1:1
     SPI1CON1bits.CKP = 0; 	//?????????? ????????? ??? ???????? ???????? ???????? ?????? ???????,
// ???????? ????????? – ??????? ???????;
     SPI1CON1bits.MSTEN = 1; 	//???????? ????? ????????
     SPI1STATbits.SPIEN = 1;	 //???????? ?????? SPI
     // ????????????? ??????, ????? ?? ??????? ?????????? ?????? 0,1 ???.
     T3CONbits.TON=0;		//?????? 3 ????????,
     T3CONbits.TCS=0;		//???????? ?????? ??????????,
     T3CONbits.TGATE=0;	 	// ????????? ????? GATE
     T3CONbits.TCKPS=0b11;  	// ???????????? ????????????? 1:256
     PR3=0x061A;			// ??????? ???????? ???????, ??????????? ?? 0,1?.
     _T3IP=1;			// ???????????? ????????? ?????????? ??????? 3 ?????? 1
     _T3IE=1;			// ????????? ?????????? ??????? 3
     T3CONbits.TON=1;		//???????? ?????? 3,


    while (1)
    {   
        SPI1BUF = 0b11111111;
        LATBbits.LATB10 = 0b11111111;
    }
}
//!U1STAbits.UTXBF
